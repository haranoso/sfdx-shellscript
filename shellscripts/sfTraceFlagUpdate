#!/bin/bash
set -eu
if [ $# -eq 0 ]; then
echo "  sfTraceFlagUpdate {-N ”<ユーザ名>”｜-i ”<ユーザID>” >"
echo "    : デバッグ用の追跡フラグをユーザ名またはID指定で更新する。実行時から２４時間"
echo "    : -N ”<ユーザ名>”:ユーザ名　User.Name"
echo "    : -i  -i ”<ユーザID>”:ユーザId　User.Id"  
  exit 1;
fi

for OPT in "$@"
do
  case $OPT in
    -i ) ID=`sfdx force:data:record:get -t -s TraceFlag -w "TracedEntityId='$2'" |grep -e ^Id: |sed -e 's/Id://g' -e 's/\"//g'`
    shift 2;;
    -n ) ID=`sfdx force:data:record:get -t -s TraceFlag -w "TracedEntity.Name='$2'" |grep -e ^Id: |sed -e 's/Id://g' -e 's/\"//g'` 
    shift 2;;
    -h )
echo "  sfTraceFlagUpdate {-N ”<ユーザ名>”｜-i ”<ユーザID>” >"
echo "    : デバッグ用の追跡フラグをユーザ名またはID指定で更新する。実行時から２４時間"
echo "    : -N ”<ユーザ名>”:ユーザ名　User.Name"
echo "    : -i  -i ”<ユーザID>”:ユーザId　User.Id"  
    shift 2;;
    --)
    shift
    exit 2;
  esac
done


START=`date -u "+%Y-%m-%dT%H:%M:%S.000+0000"`

sfdx force:data:record:update -t -s TraceFlag -i $ID -v "StartDate=$START ExpirationDate=''"

exit 0;